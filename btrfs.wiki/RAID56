== Status ==

From 3.19, the recovery and rebuild code was integrated. This brings the implementation to the point where it should be usable for most purposes. Since this is new code, you should expect it to stabilize over the next couple of kernel releases.

The one missing piece, from a reliability point of view, is that it is still vulnerable to the parity RAID "write hole", where a partial write as a result of a power failure may result in inconsistent parity data.

* Parity may be inconsistent after a crash (the "write hole")
* No support for discard? (possibly -- needs confirmation with cmason)
* The algorithm uses as many devices as are available: No support for a fixed-width stripe (see note, below)

If you'd like to learn btrfs raid5/6 and rebuilds by example (based on kernel 3.14), you can look at [http://marc.merlins.org/perso/btrfs/post_2014-03-23_Btrfs-Raid5-Status.html Marc MERLIN's page about btrfs raid 5/6].

== Note ==


Using as many devices as are available means that there will be a performance issue for filesystems with large numbers of devices. It also means that filesystems with different-sized devices will end up with differing-width stripes as the filesystem fills up, and some space may be wasted when the smaller devices are full. Both of these issues can be addressed by specifying a fixed-width stripe, always running over exactly the same number of devices.



== The history ==

RAID-5 was [http://marc.info/?l=linux-btrfs&m=133855691115496&w=2 due to arrive in 3.5], but didn't make it in time because of a serious bug. The feature also [http://marc.info/?l=linux-btrfs&m=134333725309451&w=2 missed 3.6], because two other large and important features also had to go in, and there wasn't time to complete the full testing programme for all three features before the 3.6 merge window. 

(From the 3.7 [http://marc.info/?l=linux-btrfs&m=134987008202744&w=2 pull request]):
:"I'm cooking more unrelated RAID code, but I wanted to make sure <nowiki>[the rest of the pull request]</nowiki> makes it in. The largest updates here are relatively old and have been in testing for some time."

(From the 3.8 [http://marc.info/?l=linux-btrfs&m=135578070809380&w=2 pull request]):
:"raid5/6 is being rebased against the device replacement code. I'll have it posted this Friday along with a nice series of benchmarks."
::-- It didn't make it into the pull for 3.8.